;/*FB_PKG_DELIM*/

__d("WAWebCtwa3pdConversionWamEvent",["WAWebWamCodegenUtils"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({Ctwa3pdConversion:[5138,{ctwa3pdConversionMetadata:[1,a.TYPES.STRING],ctwa3pdConversionSubtype:[2,a.TYPES.STRING],ctwa3pdConversionType:[3,a.TYPES.STRING],ctwa3pdSchemaVersion:[4,a.TYPES.INTEGER],ctwa3pdSurfaceType:[5,a.TYPES.STRING],ctwaSignals:[7,a.TYPES.STRING],ctwaTrackingPayload:[6,a.TYPES.STRING]},[1,1,1],"regular"]},{Ctwa3pdConversion:[]});g.Ctwa3pdConversionWamEvent=b}),98);
__d("WAWebSmb3pdConversionSignalAction",["WASmaxInBizSettingsEnums","WAWebBizGatingUtils","WAWebCTWAConstants","WAWebCTWADataSharingModel","WAWebChatModel","WAWebCommonCTWADataSharing","WAWebCtwa3pdConversionWamEvent","WAWebFrontendMsgGetters","WAWebLabelCollection","WAWebMsgModel","WAWebOrderStatus"],(function(a,b,c,d,e,f,g){var h=function(a,b){if(b==="order_created"||a==null)return"processing";b;switch(a){case d("WAWebOrderStatus").OrderStatus.Shipped:return"shipped";case d("WAWebOrderStatus").OrderStatus.Complete:case d("WAWebOrderStatus").OrderStatus.Delivered:return"completed";case d("WAWebOrderStatus").OrderStatus.Canceled:return"canceled";case d("WAWebOrderStatus").OrderStatus.Processing:case d("WAWebOrderStatus").OrderStatus.Pending:case d("WAWebOrderStatus").OrderStatus.PartiallyShipped:case d("WAWebOrderStatus").OrderStatus.PreparingToShip:case d("WAWebOrderStatus").OrderStatus.PaymentRequested:return"processing"}},i=function(a){var b=a.chat,e=a.surface,f=a.type,g=a.subType,i=a.orderStatus;a=a.paidData;b=c("WAWebCommonCTWADataSharing").getCTWAEligibilityFromChat(b);if(b==null)return;if(d("WAWebCTWADataSharingModel").CTWADataSharingModel.getValue()!==d("WASmaxInBizSettingsEnums").ENUM_FALSE_NOTSET_TRUE["true"])return;i=g==null?h((i=i)!=null?i:null,f):g;g={ctwa3pdSchemaVersion:2,ctwa3pdSurfaceType:e,ctwa3pdConversionType:f,ctwa3pdConversionSubtype:i,ctwa3pdConversionMetadata:JSON.stringify(a)};b.data!=null&&(g.ctwaTrackingPayload=b.data);new(d("WAWebCtwa3pdConversionWamEvent").Ctwa3pdConversionWamEvent)(g).commit()},j=function(a,b,c){a=d("WAWebLabelCollection").LabelCollection.get(a);if(a==null)return;a=a.predefinedId;if(a==null)return;if(!d("WAWebCTWAConstants").ALLOWED_PREDEFINED_LABEL_IDS_SET.has(a)&&!(a===d("WAWebCTWAConstants").NEW_CUSTOMER_LABEL_ID&&d("WAWebBizGatingUtils").is3pdSignalNewCustomerEnabled()||(a===d("WAWebCTWAConstants").FOLLOW_UP_LABEL_ID||a===d("WAWebCTWAConstants").LEAD_LABEL_ID)&&d("WAWebBizGatingUtils").is3pdLeadOptimisationLabelSignalsEnabled()))return;var e;a===d("WAWebCTWAConstants").FOLLOW_UP_LABEL_ID||a===d("WAWebCTWAConstants").LEAD_LABEL_ID?e="lead_created":a===d("WAWebCTWAConstants").ALLOWED_PREDEFINED_LABEL_IDS.NEW_ORDER||a===d("WAWebCTWAConstants").NEW_CUSTOMER_LABEL_ID?e="order_created":e="order_updated";var f,g={};switch(a){case d("WAWebCTWAConstants").NEW_CUSTOMER_LABEL_ID:f="new_customer";g={paid:!1};break;case d("WAWebCTWAConstants").ALLOWED_PREDEFINED_LABEL_IDS.ORDER_COMPLETE:f="order_complete";g={paid:!1};break;case d("WAWebCTWAConstants").ALLOWED_PREDEFINED_LABEL_IDS.NEW_ORDER:f="new_order";g={paid:!1};break;case d("WAWebCTWAConstants").ALLOWED_PREDEFINED_LABEL_IDS.PAID:f="paid";g={paid:!0};break;case d("WAWebCTWAConstants").ALLOWED_PREDEFINED_LABEL_IDS.PENDING_PAYMENT:f="pending_payment";g={paid:!1};break;case d("WAWebCTWAConstants").FOLLOW_UP_LABEL_ID:f="follow_up";break;case d("WAWebCTWAConstants").LEAD_LABEL_ID:f="lead";break}i({paidData:g,chat:b,surface:c,type:e,subType:f})};a=function(a){var b=a.chat,c=a.type,e=a.orderStatus,f=a.paidData;a=a.isPaidStateChanged;if(!d("WAWebBizGatingUtils").smbDataSharingConsentEnabled())return;b={surface:"order",chat:b,type:c,orderStatus:e,paidData:f};a===!0&&(b.subType="paid_change");i(b)};var k=function(a,b){var c="label_chat";a.forEach(function(a){b.forEach(function(b){j(b,a,c)})})},l=function(a,b){var c="label_message";a.forEach(function(a){var e=d("WAWebFrontendMsgGetters").getChat(a);b.forEach(function(a){j(a,e,c)})})};b=function(a,b){if(a.length===0||b.length===0)return;a=a.reduce(function(a,b){b instanceof d("WAWebChatModel").Chat?a.chats.push(b):b instanceof d("WAWebMsgModel").Msg&&a.messages.push(b);return a},{chats:[],messages:[]});var c=a.chats;a=a.messages;c.length>0&&d("WAWebBizGatingUtils").isSMBLabelsDataSharingEnabledForChats()&&k(c,b);a.length>0&&d("WAWebBizGatingUtils").isSMBLabelsDataSharingEnabledForMessages()&&l(a,b)};g.log3pdConversionSignalForOrders=a;g.log3pdConversionSignalForChatsOrMessages=b}),98);
__d("WAWebWamEnumCustomerAdsSharingSettingEnabled",[],(function(a,b,c,d,e,f){a=Object.freeze({UNSET:0,TRUE:1,FALSE:2});f.CUSTOMER_ADS_SHARING_SETTING_ENABLED=a}),66);